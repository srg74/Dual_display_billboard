[env]
platform = espressif32
framework = arduino
lib_deps = 
  bodmer/TFT_eSPI @ ^2.5.43
  esphome/ESPAsyncWebServer-esphome @ ^3.4.0
  esphome/ESPAsyncTCP-esphome @ ^2.0.0
  bodmer/TJpg_Decoder @ ^1.1.0
  mrrwa/NmraDcc @ ^2.0.17

[platformio]
default_envs = esp32dev

[env:esp32dev]
platform = espressif32
board = wemos_d1_mini32
framework = arduino
monitor_speed = 115200
lib_deps = 
    esphome/ESPAsyncWebServer-esphome @ ^3.4.0
    esphome/ESPAsyncTCP-esphome @ ^2.0.0
    bodmer/TFT_eSPI @ ^2.5.43
    bodmer/TJpg_Decoder @ ^1.1.0
build_flags = 
    -DCORE_DEBUG_LEVEL=3
    -DLOGGER_ENABLED=1
    -DLOGGER_LEVEL_ERROR=1
    -DLOGGER_LEVEL_WARN=1
    -DLOGGER_LEVEL_INFO=1
    -DLOGGER_LEVEL_DEBUG=0
    -DLOGGER_LEVEL_VERBOSE=0
    -DDISPLAY_TYPE_ST7735
    -DDUAL_DISPLAY_ENABLED
    ; Working TFT configuration
    -DUSER_SETUP_LOADED=1
    -DST7735_DRIVER
    -DST7735_GREENTAB160x80
    -DTFT_WIDTH=80
    -DTFT_HEIGHT=160
    -DTFT_RGB_ORDER=TFT_BGR  
    -DTFT_RST=4  
    -DTFT_DC=14
    -DTFT_MOSI=23
    -DTFT_SCLK=18
    -DTOUCH_CS=-1
    -DLOAD_GLCD   
    -DLOAD_FONT2  
    -DLOAD_FONT4  
    -DLOAD_FONT6  
    -DLOAD_FONT7  
    -DLOAD_FONT8  
    -DLOAD_GFXFF
    -DSMOOTH_FONT
    -DSPI_FREQUENCY=27000000
board_build.filesystem = littlefs
board_build.partitions = tools/ESP32_4MB_1MB_FS.csv
monitor_filters = 
    esp32_exception_decoder
    time
    log2file
extra_scripts = 
    pre:tools/minify.py

# Production build (minimal logging) - DON'T inherit build_flags
[env:esp32dev-production]
platform = espressif32
board = wemos_d1_mini32
framework = arduino
monitor_speed = 115200
lib_deps = 
    esphome/ESPAsyncWebServer-esphome @ ^3.4.0
    esphome/ESPAsyncTCP-esphome @ ^2.0.0
    bodmer/TFT_eSPI @ ^2.5.43
    bodmer/TJpg_Decoder @ ^1.1.0
build_flags = 
    -DCORE_DEBUG_LEVEL=3
    -DBOARD_HAS_PSRAM=0
    -DLOGGER_ENABLED=1
    -DLOGGER_LEVEL_ERROR=1
    -DLOGGER_LEVEL_WARN=0
    -DLOGGER_LEVEL_INFO=0
    -DLOGGER_LEVEL_DEBUG=0
    -DLOGGER_LEVEL_VERBOSE=0
    -DDISPLAY_TYPE_ST7735
    -DDUAL_DISPLAY_ENABLED
    ; Working TFT configuration
    -DUSER_SETUP_LOADED=1
    -DST7735_DRIVER
    -DST7735_GREENTAB160x80
    -DTFT_WIDTH=80
    -DTFT_HEIGHT=160
    -DTFT_RGB_ORDER=TFT_BGR  
    -DTFT_RST=4  
    -DTFT_DC=14
    -DTFT_MOSI=23
    -DTFT_SCLK=18
    -DTOUCH_CS=-1
    -DLOAD_GLCD   
    -DLOAD_FONT2  
    -DLOAD_FONT4  
    -DLOAD_FONT6  
    -DLOAD_FONT7  
    -DLOAD_FONT8  
    -DLOG_GFXFF
    -DSMOOTH_FONT
    -DSPI_FREQUENCY=27000000
board_build.filesystem = littlefs
board_build.partitions = tools/ESP32_4MB_1MB_FS.csv
monitor_filters = 
    esp32_exception_decoder
    time
    log2file

[env:esp32dev-silent]
platform = espressif32
board = wemos_d1_mini32
framework = arduino
monitor_speed = 115200
lib_deps = 
    esphome/ESPAsyncWebServer-esphome @ ^3.4.0
    esphome/ESPAsyncTCP-esphome @ ^2.0.0
    bodmer/TFT_eSPI @ ^2.5.43
    bodmer/TJpg_Decoder @ ^1.1.0
build_flags = 
    -DCORE_DEBUG_LEVEL=1
    -DBOARD_HAS_PSRAM=0
    -DLOGGER_ENABLED=0
    -DLOGGER_LEVEL_ERROR=0
    -DLOGGER_LEVEL_WARN=0
    -DLOGGER_LEVEL_INFO=0
    -DLOGGER_LEVEL_DEBUG=0
    -DLOGGER_LEVEL_VERBOSE=0
    -DDISPLAY_TYPE_ST7735
    -DDUAL_DISPLAY_ENABLED
    ; Working TFT configuration
    -DUSER_SETUP_LOADED=1
    -DST7735_DRIVER
    -DST7735_GREENTAB160x80
    -DTFT_WIDTH=80
    -DTFT_HEIGHT=160
    -DTFT_RGB_ORDER=TFT_BGR  
    -DTFT_RST=4  
    -DTFT_DC=14
    -DTFT_MOSI=23
    -DTFT_SCLK=18
    -DTOUCH_CS=-1
    -DLOAD_GLCD   
    -DLOAD_FONT2  
    -DLOAD_FONT4  
    -DLOAD_FONT6  
    -DLOAD_FONT7  
    -DLOAD_FONT8  
    -DLOAD_GFXFF
    -DSMOOTH_FONT
    -DSPI_FREQUENCY=27000000
board_build.partitions = tools/ESP32_4MB_1MB_FS.csv
monitor_filters = 
    esp32_exception_decoder

[env:esp32dev-safe]
platform = espressif32
board = wemos_d1_mini32
framework = arduino
monitor_speed = 115200
lib_deps = 
    ; NO libraries for ultra-safe mode
build_flags = 
    -DCORE_DEBUG_LEVEL=3
    -DBOARD_HAS_PSRAM=0
    -DCONFIG_SPIRAM_SUPPORT=0
    -DSAFE_MODE_ONLY=1
    -DLOGGER_LEVEL_ERROR=0
    -DLOGGER_LEVEL_WARN=0
    -DLOGGER_LEVEL_INFO=0
    -DLOGGER_LEVEL_DEBUG=0
    -DLOGGER_LEVEL_VERBOSE=0
build_src_filter = 
    +<main.cpp>
    -<display_manager.cpp>
    -<wifi_manager.cpp>
    -<credential_manager.cpp>
    -<logger.cpp>
monitor_filters = 
    esp32_exception_decoder
    time

[env:esp32dev-tft-test]
platform = espressif32
board = wemos_d1_mini32
framework = arduino
monitor_speed = 115200
lib_deps = 
    bodmer/TFT_eSPI @ ^2.5.43
build_flags = 
    -DCORE_DEBUG_LEVEL=3
    -DBOARD_HAS_PSRAM=0
    -DCONFIG_SPIRAM_SUPPORT=0
    -DTFT_TEST_ONLY=1
    -DUSER_SETUP_LOADED=1
    -DST7735_DRIVER
    -DST7735_GREENTAB160x80
    -DTFT_WIDTH=80
    -DTFT_HEIGHT=160
    -DTFT_RGB_ORDER=TFT_BGR  
    -DTFT_RST=4  
    -DTFT_DC=14
    -DTFT_MOSI=23
    -DTFT_SCLK=18
    -DTOUCH_CS=-1
    -DLOAD_GLCD   
    -DLOAD_FONT2  
    -DLOAD_FONT4  
    -DLOAD_FONT6  
    -DLOAD_FONT7  
    -DLOAD_FONT8  
    -DLOAD_GFXFF
    -DSMOOTH_FONT
    -DSPI_FREQUENCY=27000000
build_src_filter = 
    +<main.cpp>
    -<display_manager.cpp>
    -<wifi_manager.cpp>
    -<credential_manager.cpp>
    -<logger.cpp>
monitor_filters = 
    esp32_exception_decoder
    time